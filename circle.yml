machine:
  environment:
    SBT_VERSION: 0.13.11
    JAVA_OPTS: -Xmx3G -XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled -XX:MaxPermSize=2G
    SCALA_VERSION: 2.11.8
    SPARK_HOME: $HOME/spark
    M2_HOME: $SPARK_HOME/apache-maven-3.3.9
    M2: $M2_HOME/bin    
    MAVEN_OPTS: "-Xmx2g -XX:MaxPermSize=512M -XX:ReservedCodeCacheSize=512m"
dependencies:
  pre:
    - wget http://mirror.stjschools.org/public/apache/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.tar.gz
    - tar -zxvf apache-maven-3.3.9-bin.tar.gz
    - which mvn 
    - echo $SPARK_HOME
    - ls -al $SPARK_HOME
    - mkdir $HOME/.bintray
    - echo -e "realm = Bintray\nhost = dl.bintray.com\nuser = ${BINTRAY_USER}\npassword = ${BINTRAY_PASSWORD}" > $HOME/.bintray/.download_credentials
    - echo -e "realm = Bintray API Realm\nhost = api.bintray.com\nuser = ${BINTRAY_USER}\npassword = ${BINTRAY_PASSWORD}" > $HOME/.bintray/.credentials
    - wget --output-document=$HOME/bin/sbt-launch.jar https://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt-launch/"$SBT_VERSION"/sbt-launch.jar
    - echo "java $JAVA_OPTS -jar \`dirname \$0\`/sbt-launch.jar \"\$@\"" > $HOME/bin/sbt
    - ./make-distribution.sh  --name spark-1.6.2-hadoop-2.6.2-scala-2.11 --tgz --mvn $M2/mvn -Phadoop-2.6 -Dhadoop.version=2.6.2 -Dscala-2.11 -Phive -DskipTests
  cache_directories:
    - "~/.ivy2"
    - "~/.sbt"
    - "~/.m2"
